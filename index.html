<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TexasDentalHub | Houston Metro Dentists</title>
  <meta name="description" content="Find trusted general and family dentists in Houston, Katy, Sugar Land, Richmond, Rosenberg, The Woodlands, and Spring, Texas." />
<style>

:root {
  --bg: radial-gradient(circle at top, #f8fbff 0%, #eef4ff 35%, #eaf0fb 100%);
  --card: #ffffff;
  --text: #0f172a;
  --muted: #475569;
  --border: rgba(15,23,42,.08);

  --shadow-soft: 0 8px 20px rgba(2,6,23,.06);
  --shadow: 0 18px 40px rgba(2,6,23,.10);
  --shadow2: 0 12px 28px rgba(2,6,23,.12);

  --accent: #2563eb;
  --accentSoft: #eef4ff;

  --radius: 18px;
}

  --card: #ffffff;
  --text: #0f172a;
  --muted: #475569;
  --border: rgba(15,23,42,.08);

  --shadow-soft: 0 8px 20px rgba(2,6,23,.06);
  --shadow: 0 18px 40px rgba(2,6,23,.10);
  --shadow2: 0 12px 28px rgba(2,6,23,.12);

  --accent: #2563eb;
  --accentSoft: #eef4ff;

  --radius: 18px;
}

    
    *{box-sizing:border-box}
    
    body {
  margin: 0;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
}

    
    .topbar{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--border);z-index:10}
    .topbar-inner{max-width:1100px;margin:0 auto;padding:14px 18px;display:flex;justify-content:space-between;align-items:center}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;font-size:18px;color:var(--accent)}
    .brand span{font-size:22px}
    .nav button{background:none;border:none;padding:8px 12px;border-radius:999px;cursor:pointer;font-size:14px}
    .nav button.active{background:rgba(37,99,235,.12);color:#1e88ff}
    .container{max-width:1100px;margin:0 auto;padding:22px 18px 60px}
    
.hero {
  background: linear-gradient(180deg, #ffffff, #f3f7ff);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 30px;
  box-shadow: var(--shadow);
}

    
.hero h1 {
  font-weight: 700;
  letter-spacing: -0.3px;
}

    
    .hero p{margin:0;color:var(--muted)}
    .section{margin-top:28px}
    .section h2{display:flex;align-items:center;gap:8px;font-size:20px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:600px){.grid{grid-template-columns:1fr}}
    
  .card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 18px;
  box-shadow: var(--shadow-soft);
  display: flex;
  flex-direction: column;
  transition: transform .18s ease, box-shadow .18s ease;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow);
}

    
    .card:hover{transform:translateY(-3px);box-shadow:0 18px 40px rgba(2,6,23,.18)}
    
    .card.featured {
  border: 1.5px solid var(--accent);
  background: linear-gradient(180deg, #ffffff, #f5f9ff);
}

    
    .badge{background:var(--accent);color:#fff;padding:4px 10px;border-radius:999px;font-size:12px;font-weight:600;align-self:flex-start;display:flex;align-items:center;gap:6px}
    .address{color:var(--muted);font-size:14px;display:flex;gap:6px;margin:6px 0 10px 0}
    

/* App-like primary buttons */
.btn {
  margin-top: auto;
  padding: 12px 16px;
  border-radius: 14px;
  border: none;

  background: linear-gradient(180deg, #3b82f6, #2563eb);
  color: #fff;

  font-weight: 600;
  font-size: 14px;

  cursor: pointer;
  text-align: center;

  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;

  transition: transform .12s ease, box-shadow .12s ease;
}

/* Hover / focus (desktop & keyboard) */
.btn:hover,
.btn:focus-visible {
  transform: translateY(-1px);
  box-shadow: 0 10px 20px rgba(37,99,235,.35);
}

/* Press feedback (mobile & desktop) */
.btn:active {
  transform: translateY(0) scale(0.98);
}

    
    
    .page{display:none}.page.active{display:block}
    .footer{text-align:center;color:var(--muted);font-size:13px;padding:20px}
    #leadModal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:1000;align-items:center;justify-content:center}
    #leadModal .modal{background:#fff;max-width:420px;width:90%;border-radius:16px;padding:22px}
    #leadModal input,#leadModal textarea{width:100%;padding:10px;margin:8px 0;border-radius:10px;border:1px solid var(--border)}
    
.filters {
  margin: 20px 0;
  background: #fff;
  border-radius: 18px;
  padding: 14px 14px 12px;
  box-shadow: 0 8px 20px rgba(2,6,23,.08);
  border: 1px solid var(--border);
}


.filter-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}

.filters select {
  appearance: none;
  -webkit-appearance: none;

  padding: 12px 38px 12px 14px;
  border-radius: 14px;
  border: 1px solid var(--border);
  font-size: 14px;
  background:
    #fff
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' fill='%2364758b'%3E%3Cpath d='M3 5l4 4 4-4'/%3E%3C/svg%3E")
    no-repeat right 14px center;
  cursor: pointer;
}

/* Subtle press feedback (app-like feel) */
.filters select {
  transition: transform .08s ease, box-shadow .12s ease;
}

.filters select:active {
  transform: scale(0.985);
}



@media (max-width: 700px) {
  .filter-row {
    grid-template-columns: 1fr 1fr;
  }
}

.filter-count {
  display: flex;
  align-items: center;
  gap: 12px;

  margin-top: 24px;
  padding-top: 6px;

  font-size: 13px;
  color: var(--muted);
  font-weight: 500;
}


.clear-filters {
  background: none;
  border: none;
  color: var(--accent);
  font-weight: 600;
  cursor: pointer;
  padding: 0;
}

.clear-filters:hover {
  text-decoration: underline;
}
    
.sticky-filter {
  position: sticky;
  top: 64px; /* below your topbar */
  z-index: 9;
}

/* Visual polish when stuck */
/* App-like sticky state */
.sticky-filter.is-stuck {
  background: rgba(255,255,255,.96);
  backdrop-filter: blur(6px);
  box-shadow: 0 12px 26px rgba(2,6,23,.14);
}


    /* Desktop sticky (already exists above) */
.sticky-filter {
  position: sticky;
  top: 64px;
  z-index: 9;
}

/* App-like sticky state */
.sticky-filter.is-stuck {
  background: rgba(255,255,255,.96);
  backdrop-filter: blur(6px);
  box-shadow: 0 12px 26px rgba(2,6,23,.14);
}


/* ðŸ‘‡ ADD THIS BELOW (Mobile override) ðŸ‘‡ */
@media (max-width: 768px) {
  .sticky-filter {
    position: relative; /* disable sticky */
    top: auto;
  }

  .sticky-filter.mobile-fixed {
    position: fixed;
    top: 56px;
    left: 0;
    right: 0;
    margin: 0 auto;
    max-width: 1100px;
    z-index: 20;
    border-radius: 0 0 16px 16px;
  }
}

    @media (max-width: 768px) {
  .filters-spacer {
    height: 88px; /* reserve space for fixed filter bar */
  }
}

    .city-select {
  padding: 8px 14px;
  border-radius: 999px;
  border: 1px solid var(--border);
  font-size: 14px;
  background: #fff;
  cursor: pointer;
}

    
  </style>
</head>

<body>
<div class="topbar">
  <div class="topbar-inner">
    <div class="brand"><span>ðŸ¦·</span>TexasDentalHub</div>
    <div class="nav">
      <select id="citySelect" class="city-select">
        <option value="houston">Houston</option>
        <option value="katy">Katy</option>
        <option value="sugarland">Sugar Land</option>
        <option value="richmond">Richmond</option>
        <option value="rosenberg">Rosenberg</option>
        <option value="woodlands">The Woodlands</option>
        <option value="spring">Spring</option>
      </select>
    </div>
  </div>
</div>

<div class="container">
  <div id="houston" class="page active"></div>
  <div id="katy" class="page"></div>
  <div id="sugarland" class="page"></div>
  <div id="richmond" class="page"></div>
  <div id="rosenberg" class="page"></div>
  <div id="woodlands" class="page"></div>
  <div id="spring" class="page"></div>
</div>

<div class="footer">Â© 2026 TexasDentalHub</div>

<!-- ================= LEAD MODAL ================= -->
<div id="leadModal">
  <div class="modal">
    <h3>Request Appointment Online</h3>
    <p id="leadClinic" style="font-size:14px;color:#475569"></p>

    <form id="leadForm">
      <!-- ðŸ”’ SOURCE OF TRUTH -->
      <input type="hidden" id="clinicNameInput" name="clinic_name" />

      <input name="patient_name" required placeholder="Your Name" />
      <input name="email" type="email" required placeholder="Email" />
      <input name="phone" required placeholder="Phone" />
      <textarea name="message" required placeholder="Preferred time / message"></textarea>

      <button class="btn" type="submit">Submit Request</button>
      <button type="button" onclick="closeLead()" style="margin-left:10px">Cancel</button>
    </form>
  </div>
</div>

<script>
/* ================= CONFIG ================= */
const SUPABASE_URL = 'https://wehhvavlbhdbcmgvdaxj.supabase.co';
const SUPABASE_KEY = 'sb_publishable_HI7wHyO6rFnczXvvEGoldg_GF-Hd2DV';

const CITY_KEY_MAP = {
  'Houston': 'houston',
  'Katy': 'katy',
  'Sugar Land': 'sugarland',
  'Richmond': 'richmond',
  'Rosenberg': 'rosenberg',
  'Spring': 'spring',
  'The Woodlands': 'woodlands'
};

let DATA = {};
let filters = {};

/* ================= LOAD CLINICS ================= */
async function loadClinicsFromSupabase() {
  const res = await fetch(`${SUPABASE_URL}/rest/v1/clinics?select=*`, {
    headers: {
      apikey: SUPABASE_KEY,
      Authorization: `Bearer ${SUPABASE_KEY}`
    }
  });

  const rows = await res.json();
  DATA = {};

  rows.forEach(c => {
    const cityKey = CITY_KEY_MAP[(c.city || '').trim()];
    if (!cityKey) return;

    if (!DATA[cityKey]) {
      DATA[cityKey] = { label: c.city, featured: [], clinics: [] };
    }

    const clinic = {
      name: c.name,
      address: c.address,
      phone: c.phone || '',
      zip: c.zip,
      services: c.services,
      insurances: c.insurances,
      accepts_new_patients: c.accepts_new_patients,
      emergency_available: c.emergency_available
    };

    (c.featured ? DATA[cityKey].featured : DATA[cityKey].clinics).push(clinic);
  });

  activateCity('houston', true);
}

/* ================= LEADS ================= */
function openLead(name) {
  document.getElementById('leadClinic').innerText = `Clinic: ${name}`;
  document.getElementById('clinicNameInput').value = name; // ðŸ”’ STATE
  document.getElementById('leadModal').style.display = 'flex';
}

function closeLead() {
  document.getElementById('leadModal').style.display = 'none';
}

async function submitLead(e) {
  e.preventDefault();

  const form = e.target;

  const payload = {
    clinic_name: document.getElementById('clinicNameInput').value,
    city: document.getElementById('citySelect').value,
    patient_name: form.patient_name.value.trim(),
    email: form.email.value.trim(),
    phone: form.phone.value.trim(),
    message: form.message.value.trim()
  };

  if (!payload.clinic_name) {
    alert('âŒ Please select a clinic first.');
    return;
  }

  try {
    const dbRes = await fetch(`${SUPABASE_URL}/rest/v1/leads`, {
      method: 'POST',
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(payload)
    });

    if (!dbRes.ok) {
      console.error(await dbRes.text());
      alert('âŒ Failed to submit request.');
      return;
    }

    // ðŸ”” Email notification (non-blocking)
    fetch(`${SUPABASE_URL}/functions/v1/send-lead-email`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    }).catch(() => {});

    alert('âœ… Appointment request submitted successfully!');
    form.reset();
    document.getElementById('clinicNameInput').value = '';
    closeLead();

  } catch (err) {
    console.error(err);
    alert('âŒ Network error.');
  }
}

/* ================= EVENTS ================= */
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('leadForm').addEventListener('submit', submitLead);
});

document.getElementById('citySelect').addEventListener('change', e => {
  activateCity(e.target.value);
});

/* ================= START ================= */
loadClinicsFromSupabase();
</script>
</body>
</html>
